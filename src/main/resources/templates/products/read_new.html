<!DOCTYPE html> 

<html layout:decorate="~{layout}" xmlns:th="http://www.thymeleaf.org"> <!-- layout.html ìƒì†-->

<div layout:fragment="content">
  <script>
    window.onload = function() {
      // ì¶”ì²œ ìƒíƒœì— ë”°ë¼ í•˜íŠ¸ ì•„ì´ì½˜ ë³€ê²½
      let hartCnt = '[[${hartCnt}]]';
      let tag='';
      if (hartCnt == 1) {
        tag = '<a href="javascript:good([[${productsVO.productsno}]])"><img src="/products/images/hart_on_50.png" style="width: 22px" title="ì¶”ì²œ"></a>';
      } else {
        tag = '<a href="javascript:good([[${productsVO.productsno}]])"><img src="/products/images/hart_off_50.png" style="width: 22px" title="ì¶”ì²œ"></a>';
      }    
      document.querySelector('#hart_panel').innerHTML = tag; 
      document.querySelector('#recom_panel').innerHTML = '([[${productsVO.recom}]])';
    }

    function good(productsno) {
      fetch("/products/good", {
        method: "post",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({productsno})
      })
      .then(response => response.json())
      .then(data => {
        if (data.isMember == 1) {
          let tag='';
          if (data.hartCnt == 1) {
            tag = '<a href="javascript:good([[${productsVO.productsno}]])"><img src="/products/images/hart_on_50.png" style="width: 22px" title="ì¶”ì²œ"></a>';
          } else {
            tag = '<a href="javascript:good([[${productsVO.productsno}]])"><img src="/products/images/hart_off_50.png" style="width: 22px" title="ì¶”ì²œ"></a>';
          }
          document.querySelector('#hart_panel').innerHTML = tag; 
          document.querySelector('#recom_panel').innerHTML = '(' + data.recom + ')';
        } else {
          alert("ë¡œê·¸ì¸í•´ì•¼ ì¶”ì²œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
          location.href='/member/login_cookie_need';  
        }
      });
    }
  </script>

  <div class='title_line'>
    <span th:text="${cateVO.grp }" class="title_line_text"></span > 
    > <span th:text="${cateVO.name}" class="title_line_text"></span > 
    > ê¸€ ì¡°íšŒ
  </div>

  <aside class="aside_right">
    <a href="javascript:location.reload();">ìƒˆë¡œê³ ì¹¨</a>
    <span class='menu_divide'>â”‚</span>
    <a th:href="@{|./list_by_cateno_grid?cateno=${cateVO.cateno}&word=${word}&now_page=${now_page}|}">ëª©ë¡</a>
    <span class='menu_divide'>â”‚</span>
    <!-- ì¡°ê±´ë¶€ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ë“¤ -->
    <a th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}"
      th:href="@{|/products/update_text?productsno=${productsVO.productsno}&now_page=${now_page}&word=${word}|}">ê¸€ ìˆ˜ì •</a>
    <span class='menu_divide' 
          th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}">â”‚</span>
    <a th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}"
      th:href="@{|./update_file?productsno=${productsVO.productsno}&word=${word}&now_page=${now_page}|}">íŒŒì¼ ìˆ˜ì •</a>
    <span class='menu_divide' 
          th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}">â”‚</span>
    <a th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}"
      th:href="@{|/products/map?cateno=${productsVO.cateno}&productsno=${productsVO.productsno}|}">ì§€ë„</a>
    <span class='menu_divide' 
          th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}">â”‚</span>
    <a th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}"
      th:href="@{|/products/youtube?cateno=${productsVO.cateno}&productsno=${productsVO.productsno}&word=${word}&now_page=${now_page}|}">Youtube</a>
    <span class='menu_divide' 
          th:if="${session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)}">â”‚</span>
    <a th:if="${(session.grade == 'admin' or (session.grade == 'supplier' and session.memberno == productsVO.memberno)) and productsVO.cateno != null}"
      th:href="@{|./delete?productsno=${productsVO.productsno}&word=${word}&now_page=${now_page}&cateno=${productsVO.cateno}|}">ì‚­ì œ</a>
  </aside>

  <div class='menu_line'></div>

  <!-- âœ… âœ… ì¢Œìš° 2ë‹¨ ë ˆì´ì•„ì›ƒ êµ¬ì¡° ì ìš© ì‹œì‘ (ì „ì²´ ê¸°ëŠ¥ í¬í•¨) -->
  <fieldset class="fieldset_basic">
    <ul>
      <li class="li_none">
        <div class="products_read_container">

          <!-- ğŸ ì¢Œì¸¡ ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ -->
          <div class="products_read_image_box">
            <div class="swiper">
              <div class="swiper-wrapper">
                <div class="swiper-slide" th:if="${productsVO.file1saved != null && productsVO.file1saved.length() > 0}">
                  <img th:src="@{|/products/storage/${productsVO.file1saved}|}" style="width: 100%;">
                </div>
                <div class="swiper-slide" th:if="${productsVO.file2saved != null && productsVO.file2saved.length() > 0}">
                  <img th:src="@{|/products/storage/${productsVO.file2saved}|}" style="width: 100%;">
                </div>
                <div class="swiper-slide" th:if="${productsVO.file3saved != null && productsVO.file3saved.length() > 0}">
                  <img th:src="@{|/products/storage/${productsVO.file3saved}|}" style="width: 100%;">
                </div>
              </div>
              <div class="swiper-button-prev"></div>
              <div class="swiper-button-next"></div>
              <div class="swiper-pagination"></div>
            </div>
          </div>

          <!-- ğŸ“ ìš°ì¸¡ ìƒí’ˆ ì •ë³´ -->
          <div class="products_read_info_box">
            <div style="font-size: 1.5em; font-weight: bold;" th:text="${productsVO.title}"></div>
            <div style="font-size: 1em;" th:text="${productsVO.rdate}"></div><br>
            <div style="font-size: 1.2em;">
              <b>ì •ê°€:</b> <span th:text="${#numbers.formatInteger(productsVO.price, 3, 'COMMA')}">0</span>ì›<br>
              <b>í• ì¸ìœ¨:</b> <span th:text="${productsVO.dc}">0</span>%<br>
              <b>íŒë§¤ê°€:</b> <span th:text="${#numbers.formatInteger(productsVO.saleprice, 3, 'COMMA')}">0</span>ì›<br>
              <b>í¬ì¸íŠ¸:</b> <span th:text="${productsVO.point}">0</span>p<br>
              <b>ì¬ê³ :</b> <span th:text="${productsVO.salecnt}">0</span> ê°œ<br>
            </div>
            <div class="products_read_recom" style="margin-top: 10px;">
              ì¶”ì²œ: <span id="hart_panel"></span> <span id="recom_panel"></span>
            </div>

            <!-- ğŸ“„ ë³¸ë¬¸ ë‚´ìš© ì¶œë ¥ -->
            <div class="products_read_content" style="margin-top: 20px;">
              <div th:utext="${productsVO.content}"></div>
            </div>

            <!-- ğŸ“ ë‹¤ìš´ë¡œë“œ / ì§€ë„ / ìœ íŠœë¸Œ ë§í¬ -->
            <div class="products_read_links" style="margin-top: 30px;">
              <div th:if="${productsVO.file1saved != null}">
                <a th:href="@{|/download?file=${productsVO.file1saved}|}">ğŸ“ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>
              </div>
              <div>
                <a th:href="@{|/products/map?cateno=${productsVO.cateno}&productsno=${productsVO.productsno}|}">ğŸ“ ì§€ë„ ë³´ê¸°</a>
              </div>
              <div>
                <a th:href="@{|/products/youtube?cateno=${productsVO.cateno}&productsno=${productsVO.productsno}|}">â–¶ï¸ Youtube ë³´ê¸°</a>
              </div>
            </div>

          </div>

        </div> <!-- .products_read_container ë -->
      </li>
    </ul>
  </fieldset>
  <!-- âœ… âœ… ì¢Œìš° 2ë‹¨ ë ˆì´ì•„ì›ƒ êµ¬ì¡° ì ìš© ë -->

</div>
</html>
