<!-- templates/review/list.html -->
<!-- layout.html 상속 제거 → fragment로만 사용할 것이기 때문에 -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <div th:fragment="reviewListFragment(reviewList)">

    <div class="review-list-box">
      <h4>리뷰 목록</h4>

      <!-- 리뷰 없을 경우 -->
      <div th:if="${#lists.isEmpty(reviewList)}">
        <p>작성된 리뷰가 없습니다.</p>
      </div>

      <!-- 리뷰 반복 출력 -->
      <div th:each="review : ${reviewList}" class="review-item">
        <div class="review-header">
          <strong th:text="${review.mname}">작성자</strong>
          <span class="review-date" th:text="${#dates.format(review.rdate, 'yyyy.MM.dd')}"></span>
        </div>

        <div class="review-content">
          <p th:text="${review.content}"></p>
        </div>

        <div class="review-emotion-summary">
          <span class="review-emotion">
            감정 분석:
            <span th:if="${review.emotion == 1}">😊 긍정</span>
            <span th:if="${review.emotion == 0}">☹️ 부정</span>
            <span th:if="${review.emotion == null}">❔ 분석되지 않음</span>
          </span>
          <br>
          <span class="review-summary" th:if="${review.summary != null}">
            요약: <span th:text="${review.summary}"></span>
          </span>
        </div>
        <!-- 리뷰 하단에 수정/삭제 버튼 -->
        <div th:if="${sessionMemberno != null and sessionMemberno == review.memberno}">
          <a th:href="@{'/review/update?reviewno=' + ${review.reviewno}}" class="btn btn-sm">수정</a>
          <form th:action="@{/review/delete_proc}" method="post" style="display:inline;">
            <input type="hidden" name="reviewno" th:value="${review.reviewno}" />
            <button type="submit" class="btn btn-sm" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</button>
          </form>
        </div>


        <hr>
      </div>
    </div>

  </div>
</html>
