<!DOCTYPE html>
<html layout:decorate="~{layout}">
<head>
  <!-- index 전용 CSS -->
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>
<div layout:fragment="content">

  <!-- ✅ 메인 슬라이드 (Hero 영역) -->
  <section class="index-hero">
    <div id="mainCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="/images/banner1.png" class="d-block w-100" alt="배너1">
        </div>
        <div class="carousel-item">
          <img src="/images/banner2.png" class="d-block w-100" alt="배너2">
        </div>
        <div class="carousel-item">
          <img src="/images/banner3.png" class="d-block w-100" alt="배너3">
        </div>
      </div>
      <!-- 슬라이드 버튼 -->
      <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>
  </section>

  <!-- ✅ 특가 / NEW / 베스트 -->
  <section class="index-section container">
    <div class="index-banner-grid">
      <div class="index-banner-box">
        <img src="/images/special.jpg" alt="오늘의 특가">
        <h5>오늘의 특가</h5>
      </div>
      <div class="index-banner-box">
        <img src="/images/new.jpg" alt="NEW">
        <h5>NEW</h5>
      </div>
      <div class="index-banner-box">
        <img src="/images/best.jpg" alt="베스트">
        <h5>베스트</h5>
      </div>
    </div>
  </section>

  <!-- ✅ 추천 상품
  <section class="index-products container">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="index-section-title">추천 상품</h4>
      <a href="/products/recommend" class="btn btn-sm btn-outline-light">더보기</a>
    </div>

    <div class="index-product-grid">
      <th:block th:each="product, stat : ${productList}">
        <div class="index-product-card" th:if="${stat.index < 4 and product.productsno != null}">
          <img th:src="@{|/products/storage/${product.file1saved}|}" alt="상품 이미지">
          <div class="index-product-info">
            <p class="index-product-name" th:text="${product.title}">상품명</p>
            <p class="index-product-price" th:text="|${product.price_now}원|">10,000원</p>
            <a th:href="@{|/products/read?productsno=${product.productsno}|}" class="index-btn-detail">상세보기</a>
          </div>
        </div>
      </th:block>
    </div>
  </section> -->

  <!-- 추천 상품 (iframe 삽입) -->
  <section class="index-products container" style="overflow: hidden;">
    <iframe 
      src="http://localhost:3000/recommend"
      id="recommendIframe"
      style="border: none; width: 100%; height: 600px; overflow: hidden;"
      scrolling="no">
    </iframe>
  </section>

  <script>
    window.addEventListener('message', function (e) {
      if (e.data?.type === 'resize' && typeof e.data.height === 'number') {
        const iframe = document.getElementById('recommendIframe');
        if (iframe) {
          iframe.style.height = `${e.data.height}px`;
        }
      }
    });
  </script>


  <!-- ✅ AI 서비스 배너 -->
  <section class="index-ai-banner container">
    <div class="ai-banner-grid">
      <a th:href="@{/openai/recipe}" class="ai-banner-link">
        <img src="/images/consumer-banner.jpg" alt="소비자 전용 레시피 추천" class="ai-banner-img">
      </a>
      <a th:href="@{/openai/member_img}" class="ai-banner-link">
        <img src="/images/supplier-banner.jpg" alt="공급자 전용 이미지 생성" class="ai-banner-img">
      </a>
    </div>
  </section>

</div>
</body>
</html>
