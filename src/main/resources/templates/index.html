<!DOCTYPE html>
<html layout:decorate="~{layout}" xmlns:th="http://www.thymeleaf.org">
<head>
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>
<div layout:fragment="content">

  <!-- ✅ 메인 슬라이드 -->
  <section class="index-hero">
    <div id="mainCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="/images/banner1.png" class="d-block w-100" alt="배너1">
        </div>
        <div class="carousel-item">
          <img src="/images/banner2.png" class="d-block w-100" alt="배너2">
        </div>
        <div class="carousel-item">
          <img src="/images/banner3.png" class="d-block w-100" alt="배너3">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>
  </section>

  <!-- ✅ 특가 / NEW / 베스트 -->
  <section class="index-section container">
    <div class="index-banner-grid">
      <div class="index-banner-box">
        <img src="/images/special.jpg" alt="오늘의 특가">
      </div>
      <div class="index-banner-box">
        <img src="/images/new.jpg" alt="NEW">
      </div>
      <div class="index-banner-box">
        <img src="/images/best.jpg" alt="베스트">
      </div>
    </div>
  </section>
  
  <!-- 추천 상품 (iframe 삽입) -->
  <section class="index-products container" style="overflow: hidden;">
    <iframe 
      src="http://121.78.128.177:3000/recommend"
      id="recommendIframe"
      style="border: none; width: 100%; height: 600px; overflow: hidden;"
      scrolling="no">
    </iframe>
  </section>

  <script>
    window.addEventListener("message", function(event) {
      if (event.data.type === "resize") {
        const iframe = document.getElementById("recommendIframe");
        iframe.style.height = event.data.height + "px";
      }
    });
  </script>

  <!-- ✅ 추천 기획전 -->
  <section class="index-recommend container">
    <h4 class="index-section-title">SoOn이 자랑하는 식품 카테고리들!</h4>
    <div class="recommend-grid">
      <a th:href="@{/products/list_by_cateno_grid(cateno=2)}">
        <img src="/images/event1.png" alt="채소">
      </a>
      <a th:href="@{/products/list_by_cateno_grid(cateno=3)}">
        <img src="/images/event2.png" alt="과일">
      </a>
      <a th:href="@{/products/list_by_cateno_grid(cateno=4)}">
        <img src="/images/event3.png" alt="해산물">
      </a>
      <a th:href="@{/products/list_by_cateno_grid(cateno=12)}">
        <img src="/images/event4.png" alt="소스">
      </a>
      <a th:href="@{/products/list_by_cateno_grid(cateno=13)}">
        <img src="/images/event5.png" alt="제과제빵">
      </a>
      <a th:href="@{/products/list_by_cateno_grid(cateno=27)}">
        <img src="/images/event6.png" alt="즉석조리">
      </a>
    </div>
  </section>

  <!-- ✅ 카테고리별 상품 섹션 1 -->
  <!-- ✅ 채소 -->
  <section class="index-category container">
    <h4 class="index-section-title">신선 채소</h4>
    <div class="category-flex">
      <!-- 광고 -->
      <div class="category-ad">
        <img src="/images/ad-vegetable.jpg" alt="채소 광고">
      </div>
      <!-- 상품 리스트 -->
      <div class="product-grid">
        <div th:each="product : ${vegetableList}" class="product-card">
          <a th:href="@{/products/read(productsno=${product.productsno})}">
            <img th:src="@{|/products/storage/${product.file1saved}|}" alt="상품 이미지">
            <div class="product-info">
              <p class="product-name" th:text="${product.title}">상품명</p>
              <p class="product-price" th:text="|${#numbers.formatInteger(product.saleprice, 3, 'COMMA')}원|"></p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ✅ 기존 AI 배너 유지 -->
  <section class="index-ai-banner container">
    <div class="ai-banner-grid">
      <a th:href="@{/openai/recipe}" class="ai-banner-link">
        <img src="/images/consumer-banner.jpg" alt="소비자 전용 레시피 추천" class="ai-banner-img">
      </a>
      <a th:href="@{/openai/member_img}" class="ai-banner-link">
        <img src="/images/supplier-banner.jpg" alt="공급자 전용 이미지 생성" class="ai-banner-img">
      </a>
    </div>
  </section>

  <!-- ✅ 카테고리별 상품 섹션 2 -->
  <!-- ✅ 과일 -->
  <section class="index-category container">
    <h4 class="index-section-title">싱싱 과일</h4>
    <div class="category-flex">
      <div class="category-ad">
        <img src="/images/ad-fruit.jpg" alt="과일 광고">
      </div>
      <div class="product-grid">
        <div th:each="product : ${fruitList}" class="product-card">
          <a th:href="@{/products/read(productsno=${product.productsno})}">
            <img th:src="@{|/products/storage/${product.file1saved}|}" alt="상품 이미지">
            <div class="product-info">
              <p class="product-name" th:text="${product.title}">상품명</p>
              <p class="product-price" th:text="|${#numbers.formatInteger(product.saleprice, 3, 'COMMA')}원|"></p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ✅ 광고 배너 -->
  <div class="index-ad-banner">
    <a th:href="@{/products/read(productsno=76)}">
      <img src="/images/ad-banner2.png" alt="광고 배너">
    </a>
  </div>


  <!-- ✅ 카테고리별 상품 섹션 3 -->
  <!-- ✅ 해산물 -->
  <section class="index-category container">
    <h4 class="index-section-title">신선 해산물</h4>
    <div class="category-flex">
      <div class="category-ad">
        <img src="/images/ad-meat.jpg" alt="해산물 광고">
      </div>
      <div class="product-grid">
        <div th:each="product : ${meatList}" class="product-card">
          <a th:href="@{/products/read(productsno=${product.productsno})}">
            <img th:src="@{|/products/storage/${product.file1saved}|}" alt="상품 이미지">
            <div class="product-info">
              <p class="product-name" th:text="${product.title}">상품명</p>
              <p class="product-price" th:text="|${#numbers.formatInteger(product.saleprice, 3, 'COMMA')}원|"></p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </section>
  

</div>
</body>
</html>
