<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="list_all_fragment">

<link rel="stylesheet" href="/css/calendar.css">

<!-- ✅ 카테고리 필터 + 보기 전환 -->
<div id="filter_bar">
  <select id="cateFilter" onchange="filterByCate()">
    <option value="all">전체</option>
    <option th:each="cate : ${cateList}" 
            th:value="${cate.cateno}" 
            th:text="${cate.name}">카테고리</option>
  </select>

  <!-- <div id="viewToggle">
    <button onclick="changeView('grid')">🛍️ 쇼핑몰형</button>
  </div> -->
</div>

<!-- ✅ 일정 목록 카드 -->
<div id="calendarContainer" class="grid_view">

  <div class="card" th:each="calendar : ${list}" 
       th:data-cate="${calendar.cateno}">
    <div class="img_box">
      <img th:if="${calendar.file1saved != null and calendar.file1saved != ''}"
           th:src="@{|/calendar/storage/${calendar.file1saved}|}"
           alt="썸네일">
      <img th:if="${calendar.file1saved == null or calendar.file1saved == ''}"
           src="/calendar/images/noimage.png" 
           alt="No Image">
    </div>
    <div class="info">
      <div class="label" th:text="${calendar.label}">일정 제목</div>
      <div class="date" th:text="${calendar.labeldate}">2025-07-01</div>
      <div class="cnt">조회수: <span th:text="${calendar.cnt}">0</span></div>
      <div class="btns">
        <a th:href="@{|/calendar/read/${calendar.calendarno}|}">상세</a>
        <a th:href="@{|/calendar/update/${calendar.calendarno}|}">수정</a>
        <a th:href="@{|/calendar/delete/${calendar.calendarno}|}"
           onclick="return confirm('정말 삭제하시겠습니까?');">삭제</a>
      </div>
    </div>
  </div>

</div>

<!-- ✅ 스크립트 -->
<script>
function changeView(view) {
  const container = document.getElementById('calendarContainer');
  container.className = view + '_view';
}

function filterByCate() {
  const selected = document.getElementById('cateFilter').value;
  const cards = document.querySelectorAll('#calendarContainer .card');
  cards.forEach(card => {
    const cate = card.getAttribute('data-cate');
    if (selected === 'all' || selected === cate) {
      card.style.display = 'block';
    } else {
      card.style.display = 'none';
    }
  });
}
</script>

</div>
</html>
