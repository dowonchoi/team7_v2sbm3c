<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dev.mvc.notice.NoticeDAOInter">
  <!-- 1. 공지사항 등록 -->
  <insert id="create" parameterType="dev.mvc.notice.NoticeVO">
    INSERT INTO notice (
      notice_id, title, content, cate, is_fixed, writer_id, writer_name, image
    ) VALUES (
      notice_seq.nextval, #{title}, #{content}, #{cate}, #{is_fixed, jdbcType=VARCHAR}, #{writer_id}, #{writer_name}, #{image}
    )
  </insert>

  <!-- 2. 공지사항 목록 (최신순) -->
  <select id="list" resultType="dev.mvc.notice.NoticeVO">
    SELECT *
    FROM notice
    ORDER BY is_fixed DESC, notice_id DESC
  </select>

  <!-- 3. 공지사항 상세 조회 -->
  <select id="read" parameterType="int" resultType="dev.mvc.notice.NoticeVO">
    SELECT *
    FROM notice
    WHERE notice_id = #{notice_id}
  </select>

  <!-- 4. 조회수 증가 -->
  <update id="increaseViewCount" parameterType="int">
    UPDATE notice
    SET view_count = view_count + 1,
        upd_date = SYSDATE
    WHERE notice_id = #{notice_id}
  </update>

  <!-- 5. 공지사항 수정 -->
  <update id="update" parameterType="dev.mvc.notice.NoticeVO">
    UPDATE notice
    SET title = #{title},
        content = #{content},
        cate = #{cate},
        is_fixed = #{is_fixed, jdbcType=VARCHAR},
        upd_date = SYSDATE
    WHERE notice_id = #{notice_id}
  </update>

  <!-- 6. 공지사항 삭제 -->
  <delete id="delete" parameterType="int">
    DELETE FROM notice
    WHERE notice_id = #{notice_id}
  </delete>

</mapper>
