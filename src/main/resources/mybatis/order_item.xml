<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dev.mvc.order_item.OrderItemDAOInter">

  <!-- 주문 상세 항목 등록 -->
  <insert id="create" parameterType="dev.mvc.order_item.OrderItemVO">
    INSERT INTO order_item (order_itemno,orderno,productsno,pname,thumb1,price,dc,saleprice,cnt,totalprice,point,totalpoint) 
    VALUES (order_item_seq.NEXTVAL,#{orderno},#{productsno},#{pname},#{thumb1},#{price},#{dc},#{saleprice},#{cnt},#{totalprice},#{point},#{totalpoint})
  </insert>
  
  <!-- 주문번호로 주문 상세 조회 -->
  <select id="list_by_orderno" parameterType="int" resultType="dev.mvc.order_item.OrderItemVO">
    SELECT * FROM order_item
    WHERE orderno = #{orderno}
  </select>
  
  <select id="list_by_orderno_with_memberno" resultType="dev.mvc.order_item.OrderItemVO">
    SELECT oi.*
    FROM order_item oi
      JOIN products p ON oi.productsno = p.productsno
    WHERE oi.orderno = #{orderno}
      AND p.memberno = #{memberno}
  </select>


</mapper>