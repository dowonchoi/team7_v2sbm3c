<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dev.mvc.faq.FaqDAOInter">

  <!-- 1. FAQ 등록 -->
  <insert id="create" parameterType="dev.mvc.faq.FaqVO">
    INSERT INTO faq (faq_id, cate, question, answer, writer_id)
    VALUES (faq_seq.NEXTVAL, #{cate}, #{question}, #{answer}, #{writer_id})
  </insert>

  <!-- 2. 전체 목록 조회 (최신순) -->
  <select id="list" resultType="dev.mvc.faq.FaqVO">
    SELECT faq_id, cate, question, answer, writer_id, reg_date
    FROM faq
    ORDER BY faq_id DESC
  </select>

  <!-- 3. 카테고리별 목록 조회 -->
  <select id="list_by_cate" parameterType="String" resultType="dev.mvc.faq.FaqVO">
    SELECT faq_id, cate, question, answer, writer_id, reg_date
    FROM faq
    WHERE cate = #{cate}
    ORDER BY faq_id DESC
  </select>

  <!-- 4. 상세 조회 (faq_id로) -->
  <select id="read" parameterType="int" resultType="dev.mvc.faq.FaqVO">
    SELECT faq_id, cate, question, answer, writer_id, reg_date
    FROM faq
    WHERE faq_id = #{faq_id}
  </select>

  <!-- 5. 수정 -->
  <update id="update" parameterType="dev.mvc.faq.FaqVO">
    UPDATE faq
    SET cate = #{cate},
        question = #{question},
        answer = #{answer},
        writer_id = #{writer_id}
    WHERE faq_id = #{faq_id}
  </update>

  <!-- 6. 삭제 -->
  <delete id="delete" parameterType="int">
    DELETE FROM faq
    WHERE faq_id = #{faq_id}
  </delete>
  
  <!-- 검색 (제목 + 내용) -->
  <select id="search" parameterType="String" resultType="dev.mvc.faq.FaqVO">
    SELECT * FROM faq
    WHERE question LIKE '%' || #{search} || '%'
       OR answer LIKE '%' || #{search} || '%'
    ORDER BY faq_id DESC
  </select>


</mapper>
